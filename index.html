<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Sender</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<h1>Admin Sender</h1>

<input id="itemInput" placeholder="Type item and press Enter">
<div id="items"></div>

<script>
const itemsDiv = document.getElementById('items');
let items = [];

// Simple storage in memory for demo (replace with JSON file or backend on Render Web Service)
let latestSelection = null;

// Create item box
function createItemBox(name) {
  const box = document.createElement('div');
  box.className = 'item-box';
  box.innerHTML = `<span>${name}</span>`;
  const delBtn = document.createElement('button');
  delBtn.textContent = 'Delete';
  delBtn.onclick = () => {
    items = items.filter(i => i !== name);
    box.remove();
  };
  box.appendChild(delBtn);
  itemsDiv.appendChild(box);
}

// Handle new item input
document.getElementById('itemInput').addEventListener('keypress', e => {
  if (e.key === 'Enter') {
    const val = e.target.value.trim();
    if (!val) return;
    items.push(val);
    createItemBox(val);
    e.target.value = '';
  }
});

// Endpoint to serve JSON
if (!window.location.pathname.endsWith('/choose')) {
  window.fetchItems = () => {
    return { items, latestSelection };
  };
  // Poll latestSelection every 2s
  setInterval(() => {
    if (latestSelection) {
      alert(`Item selected: ${latestSelection}`);
      latestSelection = null;
    }
  }, 2000);
}
</script>
</body>
</html>
